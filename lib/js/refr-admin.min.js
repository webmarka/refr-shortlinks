function refrMessage(s,r){jQuery("div#wpbody h2:first").after('<div id="message" class="'+s+' below-h2"><p>'+r+"</p></div>")}function refrClearAdmin(){jQuery("div#wpbody div#message").remove(),jQuery("div#wpbody div#setting-error-settings_updated").remove()}function refrBtnDisable(s,r,e){jQuery(s).find(r).css("visibility","visible"),jQuery(s).find(e).attr("disabled","disabled")}function refrBtnEnable(s,r,e){jQuery(s).find(r).css("visibility","hidden"),jQuery(s).find(e).removeAttr("disabled")}jQuery(document).ready(function(s){s.fn.divExists=function(s){var r=[].slice.call(arguments,1);return this.length&&s.call(this,r),this};var r="",e="",i="",t="",o="",a="",n="";s("div.refr-sidebox").on("click","a.admin-twitter-link",function(){return s(window).width()>765?(r=s(this).attr("href"),window.open(r,"social-share-dialog","width=626,height=436"),!1):void 0}),s("td.apikey-field-wrapper").divExists(function(){s("input#refr-api").hidePassword(!1),s("td.apikey-field-wrapper").on("click","span.password-toggle",function(){s(this).hasClass("password-visible")?(s(this).removeClass("password-visible"),s("input#refr-api").hidePassword(!1)):(s(this).addClass("password-visible"),s("input#refr-api").showPassword(!1))})}),s("div.refr-sidebox").find("a.external").attr("target","_blank"),s("tr.setting-item-types").divExists(function(){e=s(this).find("input#refr-cpt").is(":checked"),e===!0&&s("tr.secondary").show(),e===!1&&(s("tr.secondary").hide(),s("tr.secondary").find("input:checkbox").prop("checked",!1)),s("tr.setting-item-types").on("change","input#refr-cpt",function(){e=s(this).is(":checked"),e===!0&&s("tr.secondary").fadeIn(700),e===!1&&(s("tr.secondary").fadeOut(700),s("tr.secondary").find("input:checkbox").prop("checked",!1))})}),s("div#refr-post-display").on("click","input.refr-api",function(){if(a=s(this).data("post-id"),n=s(this).data("nonce"),""!==a&&""!==n){s("div#wpbody div#message").remove(),s("div#wpbody div#setting-error-settings_updated").remove(),s("div#refr-post-display").find("span.refr-spinner").css("visibility","visible"),s("div#refr-post-display").find("input.refr-api").attr("disabled","disabled"),o=s("div#refr-post-display").find("input.refr-keyw").val();var r={action:"create_refr",keyword:o,post_id:a,nonce:n};jQuery.post(ajaxurl,r,function(r){s("div#refr-post-display").find("span.refr-spinner").css("visibility","hidden"),s("div#refr-post-display").find("input.refr-api").removeAttr("disabled");var e;try{e=jQuery.parseJSON(r)}catch(i){refrMessage("error",refrAdmin.defaultError)}e.success===!0?refrMessage("updated",e.message):e.success===!1&&null!==e.message?refrMessage("error",e.message):refrMessage("error",refrAdmin.defaultError),e.success===!0&&null!==e.linkbox&&(s("div#refr-post-display").find("p.refr-submit-block").remove(),s("div#refr-post-display").find("p.refr-input-block").replaceWith(e.linkbox),s("div#edit-slug-box").append('<input type="hidden" value="'+e.linkurl+'" id="shortlink">'),s("div#edit-slug-box").append(refrAdmin.shortSubmit))})}}),s("div#refr-post-display").on("click","span.refr-delete",function(){if(a=s(this).data("post-id"),n=s(this).data("nonce"),""!==a&&""!==n){s("div#wpbody div#message").remove(),s("div#wpbody div#setting-error-settings_updated").remove();var r={action:"delete_refr",post_id:a,nonce:n};jQuery.post(ajaxurl,r,function(r){var e;try{e=jQuery.parseJSON(r)}catch(i){refrMessage("error",refrAdmin.defaultError)}e.success===!0?refrMessage("updated",e.message):e.success===!1&&null!==e.message?refrMessage("error",e.message):refrMessage("error",refrAdmin.defaultError),e.success===!0&&null!==e.refrbox&&(s("div#refr-post-display").find("p.howto").remove(),s("div#refr-post-display").find("p.refr-exist-block").replaceWith(e.linkbox),s("div#edit-slug-box").find("input#shortlink").remove(),s("div#edit-slug-box").find('a:contains("Get Shortlink")').remove())})}}),s("div.row-actions").on("click","a.refr-admin-update",function(r){if(r.preventDefault(),n=s(this).data("nonce"),""!==n&&(a=s(this).data("post-id"),""!==a)){t=s(this).parents("div.row-actions"),i=s(this).parents("tr.entry").find("td.refr-click");var e={action:"stats_refr",post_id:a,nonce:n};jQuery.post(ajaxurl,e,function(s){t.removeClass("visible");var r;try{r=jQuery.parseJSON(s)}catch(e){return!1}r.success===!0&&null!==r.clicknm&&i.find("span").text(r.clicknm)})}}),s("div.row-actions").on("click","a.refr-admin-create",function(r){if(r.preventDefault(),n=s(this).data("nonce"),""!==n&&(a=s(this).data("post-id"),""!==a)){t=s(this).parents("div.row-actions"),i=s(this).parents("div.row-actions").find("span.create-refr");var e={action:"inline_refr",post_id:a,nonce:n};jQuery.post(ajaxurl,e,function(s){t.removeClass("visible");var r;try{r=jQuery.parseJSON(s)}catch(e){return!1}r.success===!0&&null!==r.rowactn&&i.replaceWith(r.rowactn)})}}),s("div#refr-admin-status").on("click","input.refr-click-status",function(){if(n=s("input#refr_status").val(),""!==n){refrClearAdmin(),refrBtnDisable("div#refr-admin-status","span.refr-status-spinner","input.refr-click-status");var r={action:"status_refr",nonce:n};jQuery.post(ajaxurl,r,function(r){refrBtnEnable("div#refr-admin-status","span.refr-status-spinner","input.refr-click-status");var e;try{e=jQuery.parseJSON(r)}catch(i){refrMessage("error",refrAdmin.defaultError)}e.success===!0?(""!==e.baricon&&s("div#refr-admin-status").find("span.api-status-icon").replaceWith(e.baricon),""!==e.message&&s("div#refr-admin-status").find("p.api-status-text").text(e.message),""!==e.stcheck&&(s("div#refr-admin-status").find("p.api-status-actions").append(e.stcheck),s("span.api-status-checkmark").delay(3e3).fadeOut(1e3))):e.success===!1&&null!==e.message?refrMessage("error",e.message):refrMessage("error",refrAdmin.defaultError)})}}),s("div#refr-data-refresh").on("click","input.refr-click-updates",function(){if(n=s("input#refr_refresh").val(),""!==n){refrClearAdmin(),refrBtnDisable("div#refr-data-refresh","span.refr-refresh-spinner","input.refr-click-updates");var r={action:"refresh_refr",nonce:n};jQuery.post(ajaxurl,r,function(s){refrBtnEnable("div#refr-data-refresh","span.refr-refresh-spinner","input.refr-click-updates");var r;try{r=jQuery.parseJSON(s)}catch(e){refrMessage("error",refrAdmin.defaultError)}r.success===!0&&""!==r.message?refrMessage("updated",r.message):r.success===!1&&null!==r.message?refrMessage("error",r.message):refrMessage("error",refrAdmin.defaultError)})}}),s("div#refr-data-refresh").on("click","input.refr-click-import",function(){if(n=s("input#refr_import").val(),""!==n){refrClearAdmin(),refrBtnDisable("div#refr-data-refresh","span.refr-import-spinner","input.refr-click-import");var r={action:"import_refr",nonce:n};jQuery.post(ajaxurl,r,function(s){refrBtnEnable("div#refr-data-refresh","span.refr-import-spinner","input.refr-click-import");var r;try{r=jQuery.parseJSON(s)}catch(e){refrMessage("error",refrAdmin.defaultError)}r.success===!0&&""!==r.message?refrMessage("updated",r.message):r.success===!1&&null!==r.message?refrMessage("error",r.message):refrMessage("error",refrAdmin.defaultError)})}}),s("div#refr-data-refresh").on("click","input.refr-convert",function(){if(n=s("input#refr_convert").val(),""!==n){refrClearAdmin(),refrBtnDisable("div#refr-data-refresh","span.refr-convert-spinner","input.refr-convert");var r={action:"convert_refr",nonce:n};jQuery.post(ajaxurl,r,function(s){refrBtnEnable("div#refr-data-refresh","span.refr-convert-spinner","input.refr-convert");var r;try{r=jQuery.parseJSON(s)}catch(e){refrMessage("error",refrAdmin.defaultError)}r.success===!0&&""!==r.message?refrMessage("updated",r.message):r.success===!1&&null!==r.message?refrMessage("error",r.message):refrMessage("error",refrAdmin.defaultError)})}})});
